<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>PMA transfer function evaluator</title>
  <meta name="description" content="Viz demonstrating the transfer function of the particle mass analyer (PMA) from Sipkens et al. (2020).">
  <meta name="keywords" content="aerosol, particle mass analyzer, PMA, centrifugal particle mass analyzer, CPMA, aerosol particle mass analyzer, APM, particle mass">

  <meta name="title" property="og:title" content="PMA transfer function evaluator">
  <meta name="image" property="og:image" content="docs/imgs/pytferpma_preview.png">
  <meta name="author" content="Timothy Sipkens">

  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel="icon" type="image/png" href="docs/imgs/favicon.png">

  <!-- Load d3.js -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://d3js.org/d3.v4.js"></script>
  <script src="https://unpkg.com/mathjs/lib/browser/math.js" type="text/javascript"></script>
  <script src="js/tfer_pma.js"></script>

  <!-- Load fonts -->
  <link href="index.css" rel="stylesheet">
</head>



<body>

  <header id="navbar">
    <a href="#h1" id="header-logo">TFER-PMA</a>
    <a href="https://www.tandfonline.com/doi/full/10.1080/02786826.2019.1680794"
        class="nav-link" id="data-link-a" style="padding:15px 5% 15px 10px;">
      <div style="display:flex;vertical-align:middle;">
        <img id="papericon" src="docs/imgs/paper_icon.svg" style="height:14pt;padding-right:5px;">
        <img id="papericon" src="docs/imgs/paper_icon_hover.svg" style="height:14pt;padding-right:5px;">
        <span>Link to paper</span>
      </div>
    </a>
  </header>

  <div class="main">

    <a class="anchor" id="h1"></a>

    <h1>PMA TRANSFER<br>FUNCTION<br>EVALUATOR</h1>

    <img src="docs/imgs/top_G0_img.png" id="img1"></img>

    <p align="justify">
      This viz examines the transfer function of particle mass analyzers
      like the centrifugal particle mass analyer (CPMA) or aerosol particle
      mass analyzer (APM).
      We refer the reader to
      <a href="https://doi.org/10.1080/02786826.2019.1680794">
        Sipkens et al. (2020)</a>
      for more information on the underlying analytical functions. A supporting
      repository, including Python code for evaluating the PMA transfer
      function is available
      <a href="https://github.com/tsipkens/tfer-pma">here</a>.
      A Matlab version is also available
      <a href="https://github.com/tsipkens/mat-tfer-pma">here</a>.
      The default view shows contributions from
      integer charge states z = 1 through 3.
    </p>

    <p align="justify">
      <b>APM</b> (aerosol particle mass analyzer) conditions are achieved
      when ω<sub>2</sub>/ω<sub>1</sub> = 1, e.g.,
      <a href="#hgraphic" id="setapm">this point</a>.
      Typcialy <b>CPMA</b> (centrifugal particle mass analyzer) conditions
      are achieved when ω<sub>2</sub>/ω<sub>1</sub> = 0.9696, e.g.,
      <a href="#hgraphic" id="setcpma">this point</a>.
    </p>

    <p align="justify">
      We note that Case 1S, following from the approach proposed

      <body>
        <a href="https://doi.org/10.1016/0021-8502(95)00562-5">Ehara et al. (1996)</a>,
        results in various anomalies. For example, in the default view, there is
        an anomaly for the z = 1 transfer function, which appears as a linear increase
        in the transfer function for m/m* > 2. This artifact is a consequence
        of solving for the equilibrium raidus and demonstrates a limitation
        of that approach. Other anomalies include problems with calculating the
        uncharged (z = 0) contributions. The method is generally stable
        for the ω<sub>2</sub>/ω<sub>1</sub> = 1, the case originally intended by
        <a href="https://doi.org/10.1016/0021-8502(95)00562-5">Ehara et al. (1996)</a>.
    </p>


    <h3>Legend</h3>
    <div id="my_legend"></div>


    <h3>Properties</h3>

    <div class="control">
      <span class="control-label">Inner radius</span>
      <span class="control-unit">cm</span> <br>
      <input class="textinput" id="r1num" type="number" min="1" max="20" step="0.01" value="0">
    </div>
    <div class="control">
      <span class="control-label">Outer radius</span>
      <span class="control-unit">cm</span> <br>
      <input class="textinput" id="r2num" type="number" min="1" max="20" step="0.01" value="0">
    </div>

    <div class="control">
      <span class="control-label">Length</span>
      <span class="control-unit">cm</span> <br>
      <input class="textinput" id="Lnum" type="number" value="20" min="1">
    </div>

    <br>

    <div class="control">
      <span class="control-label">Flow rate</span>
      <span class="control-unit">LPM</span> <br>
      <input class="textinput" id="Qnum" type="number" min="0.5" max="100" step="0.1" value="3">
    </div>

    <div class="control">
      <span class="control-label">ω<sub>2</sub>/ω<sub>1</sub></span> <br>
      <input class="textinput" id="omegahnum" type="number" min="0.5" max="1.1" step="0.001" value="0"> <br>
      <span class="control-unit" style="line-height:10pt"></span>
    </div>

    <div class="control">
      <span class="control-label">D<sub>m</sub></span> <br>
      <input class="textinput" id="Dmnum" type="number" min="0.1" max="4" step="0.05" value="0.1">
    </div>

    <div class="control">
      <span class="control-label">ρ<sub>eff,100</sub></span>
      <span class="control-unit">kg/m³</span> <br>
      <input class="textinput" id="rhonum" type="number" min="20" max="1e4" step="20" value="20">
    </div>

    <br>

    <div class="control">
      <span class="control-label">Integer charge states </span> <br>

      <input type="checkbox" class="cbZ" id="cbZ0" value="0" unchecked>
      <label class="cb" for="cbZ0">
        Uncharged
      </label> <br>

      <input type="checkbox" class="cbZ" id="cbZ1" value="1" checked>
      <label class="cb" for="cbZ1">
        z = 1
      </label> <br>

      <input type="checkbox" class="cbZ" id="cbZ2" value="2" checked>
      <label class="cb" for="cbZ2">
        z = 2
      </label> <br>

      <input type="checkbox" class="cbZ" id="cbZ3" value="3" checked>
      <label class="cb" for="cbZ3">
        z = 3
      </label>
    </div>

    <div class="control">
      <span class="control-label">Include charging? </span> <br>
      <span class="control-unit">Wiedensohler, z = 3 <br> Gopalakrishnan, z < 3</span> <br>
      <input type="checkbox" class="fCharge" id="fCharge" value="0" unchecked>
      <label class="cb" for="fCharge"></label> <br>
    </div>

    <a class="anchor" id="hgraphic"></a>

    <h3>Setpoint</h3>

    <!-- Add a slider -->
    <div class="control">
      <span class="control-label">Mass setpoint </span> <br>
      <input type="range" name="mSlider" id="mSlider" min="1" max="23" value="8" onchange="displaymval(this.value);" class="slider"> <br>
      m* = <output id="mval">-</output> fg
    </div>

    <div class="control">
      <span class="control-label">Resolution </span> <br>
      <input type="range" name="RmSlider" id="RmSlider" min="1" max="14" value="8" onchange="displayRmval(this.value);" class="slider"> <br>
      R<sub>m</sub> = <output id="Rmval">-</output>
    </div>

    <div class="control">
      <span class="control-label">Angular speed </span> <br>
      ω = <output id="Wval">-</output> rad/s
    </div>

    <div class="control">
      <span class="control-label">Voltage </span> <br>
      V = <output id="Vval">-</output> V
    </div>

    <div class="control" style="width:95%;">
      <span class="control-label">Mobility diameter </span> <br>
      <span>d<sub>m</sub> @ m* = <output id="dmval1">-</output> nm</span> |
      <span>d<sub>m</sub> @ 2m* = <output id="dmval2">-</output> nm</span> |
      <span>d<sub>m</sub> @ 3m* = <output id="dmval3">-</output> nm</span>
    </div>

    <div id="myz" style="margin-top:10px;"></div>

    <!-- Create a div where the graph will take place -->
    <div id="my_dataviz"></div>

    <script src="docs/index.js"></script>

  </div>

  <div class="footer">
    <div class="main" style="padding-top:10px;padding-bottom:10px;">
      <h4>Citing this work</h4>

      <p>
        Code supporting this viz is open source and available in an
        <a href="https://github.com/tsipkens/tfer-pma">associated repository</a> on GitHub.
        The analytical transfer functions are given in a journal article:
      </p>

      <p>
        <a href="https://doi.org/10.1080/02786826.2019.1680794">
          T. A. Sipkens, J. S. Olfert, S. N. Rogak.
          <i>Aerosol Science and Technology</i>. (2020).
        </a>
      </p>

      <p style="padding-bottom:35px;">
        This paper should be cited when referring to the underlying functions.
      </p>

    </div>
  </div>

</body>

</html>
